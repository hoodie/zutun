<style>
</style>

<div class="card">
    <div class="card-header">
        <h3 class="card-title">Add Item</h3>
    </div>

    <div class="card-body">
        <div class="list-group">

            {#each $catalogue.items as {name, category, price}}
            <button
                class="btn category-btn list-group-item list-group-item-action d-flex justify-content-between align-items-center"
                on:click="fire('addItem', {name, category, price})" >
                {name}
                {#if price}
                <span>{price}</span>
                {/if}
                <span class="badge badge-primary">{category}</span>
            </button>
            {/each}

            {#if newItemName}
            <button class="btn category-btn list-group-item-action d-flex justify-content-between align-items-center disabled" disabled>
                {newItemName}
                <span>{newItemPrice}</span>
                <span class="badge badge-primary">{newItemCategory}</span>
            </button>
            {/if}
        </div>

        <div class="input-group mb-3">
            <input bind:value=newItemName value="" placeholder="name"/>
            {#if newItemName}
            <input bind:value=newItemPrice placeholder="price" type="text"/>
            <input bind:value=newItemCategory placeholder="category" type="text"/>
            <div class="input-group-append">
                <button on:click="addNewItem()" class="btn btn-success" type="button">add</button>
            </div>
            {/if}
        </div>

    </div>
</div>

<script>
export default {
    data: () => ({
        newItemName: "",
        newItemPrice: null,
        newItemCategory: "",
    }),

    methods: {
        addNewItem() {
            const { newItemName, newItemCategory } = this.get();
            const { catalogue: { items }} = this.store.get();
            const newItem = ({ name: newItemName, category: newItemCategory })

            this.store.set({ catalogue: {items: [...items, newItem]}});
            this.set({ newItemName: null, newItemCategory: null});
        }
    }
}
</script>