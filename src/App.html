<style>
    @import url("../node_modules/bootstrap/dist/css/bootstrap.min.css");
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col">
            <Catalogue on:addItem="addItem(event)"/>
        </div>
        <div class="col">
        {#each categories as category}
            {#if items[category].length > 0}
            <Todo category="{category}" bind:items=items[category]/>
            {/if}
        {/each}
        </div>
    </div>
</div>

<script>
    import { splice } from 'svelte-extras';

    export default {
        onupdate({current}) {
        },

        components: {
            Catalogue: './Catalogue.html',
            Todo: './Todo.html'
        },

        computed: {
            categories: ({items}) => Object.keys(items)
        },

        data: () => ({
            items:{
                shopping: [
                    { name: "Mate", done: false },
                ],
                wohnung: [
                    {name: "Staubsaugen", done: false},
                ]
            }
        }),

        methods: {
            addItem({name, category}) {
                console.log({name, category})
                const {items, categories} = this.get();
                const item = {name, done: false}

                const newCategories = [...Array.from(new Set(categories.concat(category)))];
                items[category]

                const newItems = {...items};
                newItems[category] = newItems[category] ?
                newItems[category].concat(item) : [item];

                console.dir({items: {...newItems}, categories: newCategories})
                this.set({items: {...newItems}, categories: newCategories})
            }
        }
    }
</script>
